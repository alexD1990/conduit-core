# GENERATED BY: conduit template postgresql_to_snowflake
# DESCRIPTION: Replicate PostgreSQL table into Snowflake
# LAST UPDATED: 2025-01-15

version: "1.0"
project:
  name: "pg_to_snowflake_pipeline"          # ‚ö†Ô∏è UPDATE THIS
  environment: "production"

sources:
  - type: "postgresql"
    name: "pg_source"
    config:
      host: "localhost"                     # ‚ö†Ô∏è UPDATE THIS
      port: 5432
      database: "source_db"                 # ‚ö†Ô∏è UPDATE THIS
      user: "${PG_USER}"                    # üîí
      password: "${PG_PASSWORD}"            # üîí
      table: "source_table"                 # ‚ö†Ô∏è UPDATE THIS
      incremental_key: "id"                 # üí° Recommended

destinations:
  - type: "snowflake"
    name: "snowflake_dw"
    config:
      account: "${SNOWFLAKE_ACCOUNT}"       # ‚ö†Ô∏è UPDATE THIS
      user: "${SNOWFLAKE_USER}"
      password: "${SNOWFLAKE_PASSWORD}"     # üîí
      role: "${SNOWFLAKE_ROLE:-SYSADMIN}"
      warehouse: "${SNOWFLAKE_WAREHOUSE}"
      database: "${SNOWFLAKE_DATABASE}"
      schema: "${SNOWFLAKE_SCHEMA}"
      table: "target_table"                 # ‚ö†Ô∏è UPDATE THIS

pipelines:
  - name: "pg_to_snowflake_pipeline"
    source: "pg_source"
    destination: "snowflake_dw"
    mode: "incremental"
    quality_checks:
      - column: "id"
        check: "not_null"
        action: "fail"

# üöÄ HOW TO USE:
# 1. Point to real Postgres + Snowflake.
# 2. Confirm incremental key.
# 3. Save as `pipeline.yml` and run.
