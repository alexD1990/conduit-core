# GENERATED BY: conduit template csv_to_postgresql
# DESCRIPTION: Ingest CSV into PostgreSQL
# LAST UPDATED: 2025-01-15

version: "1.0"
project:
  name: "csv_to_postgres_pipeline"  # ‚ö†Ô∏è UPDATE THIS
  environment: "production"

sources:
  - type: "csv"
    name: "csv_source"
    config:
      path: "./data/input.csv"      # ‚ö†Ô∏è UPDATE THIS
      delimiter: ","
      has_header: true

destinations:
  - type: "postgresql"
    name: "pg_dest"
    config:
      host: "localhost"             # ‚ö†Ô∏è UPDATE THIS
      port: 5432
      database: "target_db"         # ‚ö†Ô∏è UPDATE THIS
      user: "${PG_USER}"            # üîí
      password: "${PG_PASSWORD}"    # üîí
      table: "target_table"         # ‚ö†Ô∏è UPDATE THIS

pipelines:
  - name: "csv_to_postgres_pipeline"
    source: "csv_source"
    destination: "pg_dest"
    mode: "append"
    quality_checks:
      - column: "id"
        check: "not_null"
        action: "fail"

# üöÄ HOW TO USE:
# 1. Update ‚ö†Ô∏è fields, export PG_USER/PG_PASSWORD.
# 2. Save as `pipeline.yml`.
# 3. Run: `conduit run pipeline.yml`.
