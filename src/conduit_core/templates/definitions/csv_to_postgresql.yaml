# GENERATED BY: conduit template csv_to_postgresql
# DESCRIPTION: Ingest CSV into PostgreSQL
# LAST UPDATED: 2025-01-18

version: "1.0"
project:
  name: "csv_to_postgresql_pipeline"
  environment: "production"

sources:
  - name: "csv_source"
    type: "csv"
    path: "./data/input.csv"        # UPDATE THIS
    delimiter: ","
    has_header: true

destinations:
  - name: "pg_dest"
    type: "postgresql"
    host: "${PG_HOST}"              # UPDATE THIS
    port: 5432
    database: "${PG_DATABASE}"      # UPDATE THIS
    user: "${PG_USER}"              # Use environment variables
    password: "${PG_PASSWORD}"      # Use environment variables
    db_schema: "public"
    table: "target_table"           # UPDATE THIS

resources:
  - name: "csv_to_postgresql"
    source: "csv_source"
    destination: "pg_dest"
    query: ""                       # Not used for CSV sources
    mode: "append"

# HOW TO USE:
# 1. Update all marked fields
# 2. Set PG_HOST, PG_USER, PG_PASSWORD, PG_DATABASE
# 3. Save as `pipeline.yml`
# 4. Run: `conduit run pipeline.yml`
