# GENERATED BY: conduit template s3_to_postgresql
# DESCRIPTION: Ingest S3 files into PostgreSQL
# LAST UPDATED: 2025-01-15

version: "1.0"
project:
  name: "s3_to_postgres_pipeline"           # UPDATE THIS
  environment: "production"

sources:
  - type: "s3"
    name: "s3_source"
    config:
      bucket: "YOUR_BUCKET"                 # UPDATE THIS
      prefix: "path/to/files/"              # UPDATE THIS
      aws_access_key_id: "${AWS_ACCESS_KEY_ID}"
      aws_secret_access_key: "${AWS_SECRET_ACCESS_KEY}"

destinations:
  - type: "postgresql"
    name: "pg_dest"
    config:
      host: "localhost"                     # UPDATE THIS
      port: 5432
      database: "target_db"                 # UPDATE THIS
      user: "${PG_USER}"
      password: "${PG_PASSWORD}"
      table: "target_table"                 # UPDATE THIS

pipelines:
  - name: "s3_to_postgres_pipeline"
    source: "s3_source"
    destination: "pg_dest"
    mode: "append"

# HOW TO USE:
# 1. Update all fields.
# 2. Set required environment variables for credentials.
# 3. Save as `pipeline.yml`.
# 4. Run: `conduit run pipeline.yml`.
